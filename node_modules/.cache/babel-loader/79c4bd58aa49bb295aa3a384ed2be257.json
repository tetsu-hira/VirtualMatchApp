{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AIQ11\\\\Desktop\\\\5sTSX\\\\fives\\\\src\\\\components\\\\Excel.tsx\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport ExcelJS from \"exceljs\";\nimport { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Excel = () => {\n  _s();\n\n  const [data, setData] = useState([]);\n\n  const handleClickDownloadButton = async (e, format) => {\n    e.preventDefault();\n    const workbook = new ExcelJS.Workbook();\n    workbook.addWorksheet(\"sheet1\");\n    const worksheet = workbook.getWorksheet(\"sheet1\");\n    worksheet.columns = [{\n      header: \"工程\",\n      key: \"name\"\n    }, {\n      header: \"時間\",\n      key: \"time\"\n    }];\n    worksheet.addRows(data);\n    const uint8Array = format === \"xlsx\" ? await workbook.xlsx.writeBuffer() //xlsxの場合\n    : await workbook.csv.writeBuffer(); //csvの場合\n\n    const blob = new Blob([uint8Array], {\n      type: \"application/octet-binary \"\n    });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"NewFile.\" + format; //フォーマットによって拡張子を変える\n\n    a.click();\n    a.remove();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => {\n          setData(data);\n          handleClickDownloadButton(e, \"xlsx\");\n        },\n        children: \"Excel\\u5F62\\u5F0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => handleClickDownloadButton(e, \"csv\"),\n        children: \"CSV\\u5F62\\u5F0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(Excel, \"wQ7vQ41GFFni9eBcCT+YNw5qZlg=\");\n\n_c = Excel;\nexport default Excel;\n\nvar _c;\n\n$RefreshReg$(_c, \"Excel\");","map":{"version":3,"sources":["C:/Users/AIQ11/Desktop/5sTSX/fives/src/components/Excel.tsx"],"names":["React","ExcelJS","useState","Excel","data","setData","handleClickDownloadButton","e","format","preventDefault","workbook","Workbook","addWorksheet","worksheet","getWorksheet","columns","header","key","addRows","uint8Array","xlsx","writeBuffer","csv","blob","Blob","type","url","window","URL","createObjectURL","a","document","createElement","href","download","click","remove"],"mappings":";;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,SAASC,QAAT,QAAyB,OAAzB;;;;AAOA,MAAMC,KAAe,GAAG,MAAM;AAAA;;AAC5B,QAAM,CAAEC,IAAF,EAAQC,OAAR,IAAoBH,QAAQ,CAAS,EAAT,CAAlC;;AACA,QAAMI,yBAAyB,GAAG,OAChCC,CADgC,EAEhCC,MAFgC,KAG7B;AACHD,IAAAA,CAAC,CAACE,cAAF;AAEA,UAAMC,QAAQ,GAAG,IAAIT,OAAO,CAACU,QAAZ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,YAAT,CAAsB,QAAtB;AACA,UAAMC,SAAS,GAAGH,QAAQ,CAACI,YAAT,CAAsB,QAAtB,CAAlB;AAEAD,IAAAA,SAAS,CAACE,OAAV,GAAoB,CAClB;AAAEC,MAAAA,MAAM,EAAE,IAAV;AAAgBC,MAAAA,GAAG,EAAE;AAArB,KADkB,EAElB;AAAED,MAAAA,MAAM,EAAE,IAAV;AAAgBC,MAAAA,GAAG,EAAE;AAArB,KAFkB,CAApB;AAKAJ,IAAAA,SAAS,CAACK,OAAV,CAAkBd,IAAlB;AAEA,UAAMe,UAAU,GACdX,MAAM,KAAK,MAAX,GACI,MAAME,QAAQ,CAACU,IAAT,CAAcC,WAAd,EADV,CACsC;AADtC,MAEI,MAAMX,QAAQ,CAACY,GAAT,CAAaD,WAAb,EAHZ,CAdG,CAiBqC;;AACxC,UAAME,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACL,UAAD,CAAT,EAAuB;AAAEM,MAAAA,IAAI,EAAE;AAAR,KAAvB,CAAb;AACA,UAAMC,GAAG,GAAGC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2BN,IAA3B,CAAZ;AACA,UAAMO,CAAC,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAV;AACAF,IAAAA,CAAC,CAACG,IAAF,GAASP,GAAT;AACAI,IAAAA,CAAC,CAACI,QAAF,GAAa,aAAa1B,MAA1B,CAtBG,CAsB+B;;AAClCsB,IAAAA,CAAC,CAACK,KAAF;AACAL,IAAAA,CAAC,CAACM,MAAF;AACD,GA5BD;;AA8BA,sBACE;AAAA,2BACE;AAAA,8BACE;AAAQ,QAAA,OAAO,EAAG7B,CAAD,IAAO;AAACF,UAAAA,OAAO,CAACD,IAAD,CAAP;AAAeE,UAAAA,yBAAyB,CAACC,CAAD,EAAI,MAAJ,CAAzB;AAAqC,SAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAIE;AAAQ,QAAA,OAAO,EAAGA,CAAD,IAAOD,yBAAyB,CAACC,CAAD,EAAI,KAAJ,CAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF,mBADF;AAYD,CA5CD;;GAAMJ,K;;KAAAA,K;AA8CN,eAAeA,KAAf","sourcesContent":["import * as React from 'react';\r\nimport ExcelJS from \"exceljs\";\r\nimport { useState } from 'react';\r\n\r\ntype Cell = {\r\n  name: string\r\n  time: number\r\n}\r\n\r\nconst Excel: React.FC = () => {\r\n  const [ data, setData ] = useState<Cell[]>([]);\r\n  const handleClickDownloadButton = async (\r\n    e: React.MouseEvent<HTMLButtonElement, MouseEvent>,\r\n    format:  \"xlsx\" | \"csv\"\r\n  ) => {\r\n    e.preventDefault();\r\n\r\n    const workbook = new ExcelJS.Workbook();\r\n    workbook.addWorksheet(\"sheet1\");\r\n    const worksheet = workbook.getWorksheet(\"sheet1\");\r\n\r\n    worksheet.columns = [\r\n      { header: \"工程\", key: \"name\"},\r\n      { header: \"時間\", key: \"time\"}\r\n    ];\r\n\r\n    worksheet.addRows(data);\r\n    \r\n    const uint8Array =\r\n      format === \"xlsx\"\r\n        ? await workbook.xlsx.writeBuffer() //xlsxの場合\r\n        : await workbook.csv.writeBuffer(); //csvの場合\r\n    const blob = new Blob([uint8Array], { type: \"application/octet-binary \"});\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = \"NewFile.\" + format; //フォーマットによって拡張子を変える\r\n    a.click();\r\n    a.remove();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <button onClick={(e) => {setData(data); handleClickDownloadButton(e, \"xlsx\")}}>\r\n          Excel形式\r\n        </button>\r\n        <button onClick={(e) => handleClickDownloadButton(e, \"csv\")}>\r\n          CSV形式\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Excel;\r\n"]},"metadata":{},"sourceType":"module"}